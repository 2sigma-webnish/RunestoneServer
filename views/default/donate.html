{{user_navs = True}}
{{extend 'layout.html'}}

{{block statusbar}}
{{end}}

<div class="container">
    <div class="col-md-8 col-md-offset-2" style="font-size: large;">
        <h1>Support Runestone Interactive</h1>

        <p>Your support of Runestone Academy is vital to our future.
            Runestone has grown from one introductory computer science
            course in 2012 to supporting thousands of courses and hundreds of thousands of
            students! Since the Fall of 2018 Runestone Academy has saved students over
            $21 million in textbook fees!</p>
        <p>Your support ensures that great interactive textbooks
            will remain free. It also:</p>
            <ul>
                <li>Supports the ongoing development of the Runestone platform.</li>
                <li>Motivates new authors to write more books on new topics.</li>
                <li>Pays our server bills.</li>
                <li>Creates resources to train and support instructors.</li>
            </ul>
        <p>Thank You! <br/>
            Brad Miller, Founder and Chief Developer -- Runestone Academy Ltd</p>
        <div class="panel panel-default">
            <div class="panel-heading">Donation Amount</div>
            <div class="panel panel-body">
                <input type="radio" name="donate" id="donate10" value="10.00"> <label for="donate10">$10</label><br>
                <input type="radio" name="donate" id="donate20" value="20.00"> <label for="donate20">$20</label><br>
                <input type="radio" name="donate" id="donate50" value="50.00"> <label for="donate50">$50</label><br>
                Other: <input type="text" name="donate" id="donateother" value=""/><br>
                <a class="btn btn-warning" href="{{=URL('index')}}" role="button">Sorry, not Today</a><br>
                If you don't PayPal, see below for Venmo option!
            </div>
        </div>
    </div>
</div>
<div id="paypal-button-container" class="col-md-8 col-md-offset-2"></div>



<script src="https://www.paypal.com/sdk/js?client-id=AVsIrTPVGQOcMILmCSyfLioKBiqdTgAzC_ax74na1CZ0HZV0EPf9Vq7PDp_sWPeqNitq0yRGRYq5vjDp
&currency=USD&intent=capture&enable-funding=venmo" data-sdk-integration-source="integrationbuilder"></script>

    <script>
      const fundingSources = [
        paypal.FUNDING.PAYPAL,
          paypal.FUNDING.VENMO,
          paypal.FUNDING.CARD
        ]

      for (const fundingSource of fundingSources) {
        const paypalButtonsComponent = paypal.Buttons({
          fundingSource: fundingSource,

          // optional styling for buttons
          // https://developer.paypal.com/docs/checkout/standard/customize/buttons-style-guide/
          style: {
            shape: 'rect',
            height: 40,
          },

          // set up the transaction
          createOrder: (data, actions) => {
            // pass in any options from the v2 orders create call:
            // https://developer.paypal.com/api/orders/v2/#orders-create-request-body
            const createOrderPayload = {
              purchase_units: [
                {
                  amount: {
                    value: '88.44',
                  },
                },
              ],
            }

            return actions.order.create(createOrderPayload)
          },

          // finalize the transaction
          onApprove: (data, actions) => {
            const captureOrderHandler = (details) => {
              const payerName = details.payer.name.given_name
              console.log('Transaction completed!')
            }

            return actions.order.capture().then(captureOrderHandler)
          },

          // handle unrecoverable errors
          onError: (err) => {
            console.error(
              'An error prevented the buyer from checking out with PayPal',
            )
          },
        })

        if (paypalButtonsComponent.isEligible()) {
          paypalButtonsComponent
            .render('#paypal-button-container')
            .catch((err) => {
              console.error('PayPal Buttons failed to render')
            })
        } else {
          console.log('The funding source is ineligible')
        }
      }
    </script>

{{ if request.args: }}
<script>
    $(document).ready(function() {
        var amt = "{{=request.args(0)}}";
        var btn = document.getElementById("donate"+amt);
        if (btn) {
            btn.checked = true;
        }
    });
</script>
{{pass}}
